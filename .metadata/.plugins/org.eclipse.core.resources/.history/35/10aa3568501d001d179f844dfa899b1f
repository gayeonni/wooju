<html layout:decorate="~{layout}">


<div layout:fragment="content" class="container" style=" border:1px solid darkgray; margin-top:30px; box-sizing:initial; " >

<h5 class="my-3 border-bottom pb-2">ìƒí’ˆ ë“±ë¡</h5>
    
    <form th:object="${saleForm}" method="post">
    <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
        <div class="alert alert-danger" role="alert" th:if="${#fields.hasAnyErrors()}">
            <div th:each="err : ${#fields.allErrors()}" th:text="${err}" />
        </div>
    
       
       
        <div class="mb-3" style="margin-top:50px;">
         <table style="width:120%">
         <tr>
          <td>  <input type="text"  th:field="*{subject}" class="form-control" placeholder="ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”." ></td>
           <td>  <input type="submit" value="ì‘ì„±" class="btn btn-primary my-2" style="  background-color:darkgray; border-color:darkgray;">
        </td> </tr>
         </table>
        </div>
        
        <div class="mb-3">
        	<div>ì¹´í…Œê³ ë¦¬</div>
        	<select th:field="*{category}" class="form-select">
        		<option value="">==ì§€ì—­ ì„ íƒ==</option>
        		<option th:each="category : ${categoryCodes}" th:value="${category.id}" 
        		th:text="${category.name}"></option>
        </select>
       </div>
        
        
        <hr>
        <!-- ìƒí’ˆ ì‚¬ì§„ ê¸°ì¬ ë¶€ë¶„ -->
        <style>
        
        table {
  border-spacing: 10px;
   border-collapse: separate;
  }
        
    li {
      list-style: none;
    }

    img {
      width: 200px;
      height: 200px;
      border: 1px solid darkgray;
    }

    .real-upload {
      display: none;
    }


    .image-preview {
      width: 1300px;
      height: auto;
       padding-left:0px;
      display: flex;
      gap: 20px;
   
    }
    

  </style>



<div class="mb-3" >
   

    <form name="form" method="post" action="http://localhost:8080/sale/detail/{id}" enctype="multipart/form-data">
       <input type="file" id="uploadFile" name="uploadFile"  class="real-upload" accept="image/*" multiple="multiple" style="display: none; " >

  <div class="button">
                    <label for="uploadFile">
                        ğŸ‘‰ ì‚¬ì§„ ë“±ë¡í•˜ê¸° ğŸ‘ˆ
                    </label>
                   
                </div>

  
  <div class="upload" >
   
  <ul class="image-preview"  ></ul>

    </div>
    
</div>
  
   
        <hr>
        
        <div class="mb-3">
            <label for="content" class="form-label">ìƒí’ˆ ì„¤ëª…</label>
            <textarea th:field="*{content}"  class="form-control" rows="10"  placeholder="êµ¬ë§¤ ë‚ ì§œ, í•˜ì ì—¬ë¶€ ë“± ì œí’ˆì— ëŒ€í•´ ìƒì„¸í•˜ê²Œ ì„¤ëª…í•´ì£¼ì„¸ìš”.">
            </textarea>
        </div>
        
        
        
        <div class="mb-3" >
        
        <table>
        <tr>
        <td>   <label for="price" class="form-label" >ê¸ˆì•¡ </label></td>
        <td>   <input type="text" th:field="*{price}" class="form-control" placeholder="ì§ì ‘ ì…ë ¥í•˜ì„¸ìš”." style="text-align:center; width:90%"></td>
        <td>ì›</td> 
        </tr>
        </table>
        </div>
        
        
     
    </form>
    </form>
</div>

 

  
<script layout:fragment="script" type='text/javascript'>
function getImageFiles(e) {
      const uploadFiles = [];
      const files = e.currentTarget.files;
      const imagePreview = document.querySelector('.image-preview');
      const docFrag = new DocumentFragment();

      if ([...files].length >=11) {
        alert('ì´ë¯¸ì§€ëŠ” ìµœëŒ€ 10ê°œ ê¹Œì§€ ì—…ë¡œë“œê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤.');
        return;
      }

      // íŒŒì¼ íƒ€ì… ê²€ì‚¬
      [...files].forEach(file => {
        if (!file.type.match("image/.*")) {
          alert('ì´ë¯¸ì§€ íŒŒì¼ë§Œ ì—…ë¡œë“œê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤.');
          return
        }

        // íŒŒì¼ ê°¯ìˆ˜ ê²€ì‚¬
        if ([...files].length < 11) {
          uploadFiles.push(file);
          const reader = new FileReader();
          reader.onload = (e) => {
            const preview = createElement(e, file);
            imagePreview.appendChild(preview);
          };
          reader.readAsDataURL(file);
        }
      });
    }

    function createElement(e, file) {
      const li = document.createElement('li');
      const img = document.createElement('img');
      img.setAttribute('src', e.target.result);
      img.setAttribute('data-file', file.name);
      li.appendChild(img);

      return li;
    }

    const realUpload = document.querySelector('.real-upload');
    const upload = document.querySelector('.upload');

    upload.addEventListener('click', () => realUpload.click());

    realUpload.addEventListener('change', getImageFiles);
    
    
            
  </script>
  
</html>